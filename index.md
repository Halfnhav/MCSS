---
layout: default
title: MCSS
description: Многослойная система организации CSS
project-name: MCSS
project-url: https://github.com/operatino/MCSS
pages-url: /MCSS
author: <a href="https://github.com/operatino">operatino</a>

res-watch-on-github: Посмотреть на Github
res-download-archive: Скачать в архиве
---

# Многослойный CSS

## Введение
Многослойная система организации CSS основана на принципах [OOCSS](http://oocss.org/) и [БЭМ](http://bem.info/). Методология родилась и развивается в команде разработчиков [Одноклассники](http://corp.mail.ru/communications/odnoklassniki) и рекомендуется к использованию как основа для собственного свода правил и документаций.

Несмотря на то, что **MCSS** изначально был создан для организации большого количества стилей, данная методология рекомендуется и порталам среднего размера.

Документация постоянно обновляется и развивается, в том числе и в сопровождении вспомогательных инструментов, как движок документирования верстки [Source](http://sourcejs.ru).

*С вопросами можно обращаться в раздел [Issues на Github](https://github.com/operatino/MCSS/issues) или по почте <r@rhr.me>.*

### Модули документации

Согласно плану развития документации, стали доступны первые самостоятельные модули. Цель разбиения документции на модули:

* Иметь возможность глубоко описывать отдельные моменты документации не влияя на общую сложность (ядро документации останется минимальным)
* Дать возможность использовать отдельные правила из модулей в отрыве от других правил MCSS (модули максимально абстрактны и пересекаются с основной методологией поверхностными связями)

Первая группа модулей:

* [Расположение стилей]({{ page.pages-url }}/modules/css_placement.html)
* [Модификаторы]({{ page.pages-url }}/modules/modifiers.html)
* [Именование]({{ page.pages-url }}/modules/naming.html)
* [Словарь сокращений]({{ page.pages-url }}/modules/shorthand_dictionary.html)

На подходе следующие модули:

* Уровни каскада
* Правила взаимодействия слоев
* Комментирование кода

## Основные правила

Методология **MCSS** максимально абстрагирована и не акцентирует внимание на конкретном стиле написания кода, организации файлов и обязательных инструментах для работы с ней.

Блоки вёрстки делятся на модули, каждый из которых сам по себе независим и максимально абстрагирован от фиксированных размеров.

В свою очередь модули распределяются по слоям, каждый из которых имеет свой свод правил использования и взаимодействия с другими модулями.

![image]({{ page.pages-url }}/images/modules.jpg)

## Фундамент
Фундамент включает в себя ресеты и мало изменяемые стили, которые закладываются в основу вёрстки и применяются на все страницы.

Стили фундамента, как и все ресеты, подключаются с самого начала, либо в отдельном файле, либо в начале единого CSS файла.

## Компоновка модулей

![image]({{ page.pages-url }}/images/layers.jpg)

## Первый слой — базовый
Первый слой — это портальный фреймворк, ядро интерфейса, которое состоит из наиболее переиспользуемых и абстрактных конструкций, например:

* формы
* кнопки
* блоки навигации и пр.

Разметка модулей первого слоя тесно завязана на общем стиле портала и на дизайнерских гайдлайнах. При работе над базовыми конструкциями рекомендуется тесная связь с дизайнерами, особенно в решении создания общепортальных стандартов.

Внедряя методологию **MCSS** в рабочий проект, первое, с чего стоит начинать, - создать базу переиспользуемых стандартов.

Как часть первого слоя можно смело использовать такие популярные фреймворки, как [Bootstrap](http://twitter.github.com/bootstrap/), [960gs](http://960.gs/), [inuit.css](https://github.com/csswizardry/inuit.css) и пр.

### Правила
Основное правило первого слоя — абстрактность как в названиях, так и в разметке:

* Названия классов этого слоя не должны выглядеть чужеродно в любом месте на портале.
* Блоки модуля должны иметь стиль по умолчанию, но должны оставаться простыми и легко модифицируемыми под задачи различных проектных модулей.

Стили первого слоя могут быть модифицированы каскадом от 1-го и 2-го слоя. Это связано с правилом расположения смежных стилей в одном месте (см. пункт "Расположение стилей").

Ядро (1-й слой) должно быть абстрагировано от модулей 2ого слоя, пример:

Cтандарт форм:

{% highlight css %}
.input-field { }
    .input-field_text { }
{% endhighlight %}

Взаимодействия стандарта форм со стандартом кнопок - модифицирование каскадом от 1-го слоя:

{% highlight css %}
.input-field { }
    .input-field .button { }
{% endhighlight %}

Взаимодействие проектного модуля со стандартом во 2-м слое:

{% highlight css %}
.project-module { }
    .project-module .input-field { }
{% endhighlight %}

**Модификация 2-го слоя, от 1-го запрещена!** В такой ситуации слои смешиваются, вызывая беспорядок:

{% highlight css %}
    .input-field .project-module { }
{% endhighlight %}

Стили подключаются сразу после фундамента, перед 2-м слоем, для поддержания низкого уровня приоритета по весу селекторов.

### Преимущества
Переиспользуемые, продуманные модули первого слоя позволяют сэкономить время на поддержке популярных конструкций, избавляя от необходимости поддерживать сразу несколько похожих модулей. Переиспользуемость также хорошо сказывается на итоговом размере CSS-файлов.

Имея разработанную базу, легко на её основе создавать новые интерфейсы, большая часть которых состоит из стандартных элементов.

Наработки стандартных конструкций можно переиспользовать из проекта в проект для ускорения разработки вёрстки и завязанного на ней бэкэнд функционала.

## Второй слой — проектный
Второй слой включает в себя изолированные, проектные модули, из которых в дальнейшем собирается страница:

* форма регистрации
* блок логина
* корзина товаров

### Правила

В конструкциях второго слоя рекомендуется использовать как можно больше уникальных классов, даже если в конкретном дизайне блок не нуждается в стилизации, лучше заранее присвоить ему уникальный класс. Такой подход улучшает доступность каждой отдельной части конструкции, что в дальнейшем позволит легко изменять стили, не трогая HTML-конструкцию.

Каждый модуль должен быть максимально изолирован и существовать как отдельная, независимая единица портала, которая общается только с ядром / базовым слоем.

Чтобы в проектном модуле использовать конструкцию из первого слоя, нужно просто добавить рядом CSS-класс:

{% highlight html %}
<header class="toolbar">
    <a href="/" class="toolbar_logo"></a>
    <menu class="toolbar_dropdown_ul umenu">
        <li class="umenu_li"></li>
        <li class="umenu_li"></li>
    </menu>
</header>
{% endhighlight %}

В примере описан модуль второго слоя **.toolbar**, который использует стандарт первого слоя **.umenu**. Чтобы модифицировать стандарт под проектные нужды, используется каскад в CSS:

{% highlight css %}
/* Toolbar
-------------------------------------------------- */

.toolbar { }

.toolbar_dropdown_ul { }
    .toolbar_dropdown_ul .umenu_li { }

/* /Toolbar */
{% endhighlight %}

**Стили второго слоя могут быть модифицированы каскадом только от других модулей второго слоя.**

Можно:

{% highlight css %}
.project-module .other-project-module { }
{% endhighlight %}

**Нельзя:**

{% highlight css %}
.standard-module .project-module { }
{% endhighlight %}

### Преимущества
Изолированность модулей позволяет легко работать с их стилями, не боясь задеть отдельные части портала. Работая в команде, каждый может взяться за разработку отдельного модуля, не мешая другим разработчикам.

Стили каждого модуля можно подключать по отдельности только на те страницы, где они необходимы.

Если какой-то функционал исчезнет с портала, избавиться от стилей будет очень просто: достаточно лишь избавиться от файла или от секции с его стилями.

## Третий слой — косметический
Третий слой состоит из простых, мало влияющих стилей:

* цвета ссылок
* Простые OOCSS селекторы — пара свойств на класс (.font-size_XL, .margin-t_L)
* глобальные модификаторы

Слой может не существовать в некоторых вариациях использования методологии, но на больших проектах стили этого слоя позволяют решить проблему с дубликацией стилей и позволяют описывать редкие, непроектные ситуации, не плодя лишнюю разметку.

### Правила
Стили третьего слоя должны быть построены так, чтобы при их удалении вёрстка не ломалась. Максимум могут теряться какие-то незначительные стили — цвета, отступы и пр.

Позволяется использовать простые OOCSS-классы, не больше трёх на блок, для редких, не проектных ситуаций:

{% highlight html %}
<div class="font-size_XL margin-t_L color_red"></div>
{% endhighlight %}

**Стили косметического слоя нельзя модифицировать каскадом от других слоёв, кроме контекста.**

Косметические стили подключаются в самом конце, так же допускается использовать **!important**.

### Преимущества
Стиль мало влияет на общую вёрстку портала, при этом решая проблемы дублированного кода и избавляя от необходимости плодить маленькие проектные и базовые модули.

Простые селекторы позволяют быстро справляться с редкими случаями, когда нужно повесить всего пару свойств на не проектный модуль.

## Контекст
Слой включает в себя стили высшего контекста и @media-правила, которые могут использоваться для изменения стандартных стилей под особенности различного контекста:

* .ie8, .ie9 — браузеры
* .touch — особенности устройства
* .logged-in — высший контекст в рамках портала
* Media queries

Слой контекста является исключением в правиле "Расположение стилей". Стили этого слоя располагаются по всем слоям, рядом с селекторами, которые каскадом модифицируются от контекста.

{% highlight css %}
/* Module name
-------------------------------------------------- */

.module { }

.module_list { }
    .touch .module_list { }
    .ie9 .module_list { }

@media screen and (max-width: 1000px) {
    .module { }
    }

/* /Module name */
{% endhighlight %}

## Примеры использования

Посмотреть взаимодействие слоёв на практике можно на [этой странице]({{ page.pages-url }}/examples/layers/). В примере, все слои поделены на секции в одном [CSS файле]({{ page.pages-url }}/examples/layers/css/style.css), таким же образом можно делить содержание секций на отдельные файлы:

![image]({{ page.pages-url }}/images/file-system.png)

Во [втором примере]({{ page.pages-url }}/examples/mcss_with_bootstrap/), изображено взаимодействие MCSS с [Bootstrap](http://twitter.github.com/bootstrap/), в качестве первого (базового) слоя.

## Рекомендации

### Code style
Вместе с методологией советуем использовать следующие полезные практики для улучшения своего кода:

* [Google HTML/CSS style guide](http://google-styleguide.googlecode.com/svn/trunk/htmlcssguide.xml) - стайл-гайд по оформлению HTML и CSS кода
* [CSScomb](http://csscomb.ru/) - инструмент для сортировки CSS-свойств в рамках селектора
* [CSSDoc](http://cssdoc.net/) - правила оформления комментариев в CSS ([описание](http://habrahabr.ru/post/87406/))

### Best practises
* Как можно больше комментируйте CSS, любые нестандартные свойства, конструкции, магические числа — это пригодится не только членам вашей команды, но и вам, когда вы через пару месяцев вернётесь к коду (скоро в отдельном модуле MCSS)

### Ссылки
* [Видео запись](http://tohtml.it/post/43785238499/css) презентации MCSS и [слайды](http://rhr.me/pres/mcss/) c Web Standards Days
* [Модель строгости в MCSS](http://tohtml.it/post/34285787881/mcss-unstrict-mode)

## Будущее MCSS
* Обновление сайта документации
* Сопроводительные статьи с примерами реальной практики и философией
* Модульное развитие спецификации
* Перевод документации на английский язык

Следите за обновлениями в твиттере [@operatino](http://twitter.com/operatino)

[Early alpha version of english translation]({{ page.pages-url }}/en)